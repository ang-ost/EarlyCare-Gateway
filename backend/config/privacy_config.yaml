# Privacy and Security Configuration

# HIPAA Compliance
hipaa:
  enabled: true
  strict_mode: true
  require_audit: true
  require_encryption: true

# Data Anonymization
anonymization:
  enabled: true
  
  # Automatic anonymization triggers
  auto_anonymize:
    on_export: true
    on_research_use: true
    on_external_share: true
  
  # PII Detection
  pii_detection:
    enabled: true
    patterns:
      ssn: true
      phone: true
      email: true
      mrn: true
      address: true
      dates: true
    
  # Pseudonymization
  pseudonymization:
    enabled: true
    salt: "CHANGE_THIS_SALT_IN_PRODUCTION"  # Use secure random salt
    algorithm: "sha256"
  
  # Date anonymization
  date_precision: "year"  # year, month, day
  
  # Age binning
  age_binning:
    enabled: true
    bin_size: 5
    max_age: 90  # Ages above this shown as "90+"
  
  # K-Anonymity
  k_anonymity:
    enabled: false
    k_value: 5
    quasi_identifiers:
      - "age"
      - "zip_code"
      - "ethnicity"

# Encryption
encryption:
  enabled: true
  
  # Algorithm
  algorithm: "AES-256"
  mode: "CBC"
  
  # Key management
  key_rotation:
    enabled: true
    rotation_days: 90
    
  # Data at rest
  encrypt_at_rest:
    enabled: true
    paths:
      - "data/"
      - "logs/audit/"
      
  # Data in transit
  encrypt_in_transit:
    enabled: true
    tls_version: "1.3"
    require_mutual_tls: false

# Audit Logging
audit:
  enabled: true
  
  # Log retention
  retention_days: 2555  # 7 years for HIPAA
  
  # Events to log
  log_events:
    data_access: true
    data_modification: true
    data_deletion: true
    data_export: true
    user_authentication: true
    model_execution: true
    consent_changes: true
    permission_changes: true
    system_config: true
  
  # Storage
  storage:
    directory: "logs/audit"
    format: "json"
    compress: true
    encryption: true
    
  # Integrity
  integrity_checks:
    enabled: true
    hash_algorithm: "sha256"

# Access Control
access_control:
  enabled: true
  
  # Role-based access control (RBAC)
  rbac:
    enabled: true
    default_role: "viewer"
    
  # Roles and permissions
  roles:
    admin:
      - "system:*"
    physician:
      - "patient:read"
      - "patient:write"
      - "model:execute"
      - "data:export"
    nurse:
      - "patient:read"
      - "data:view"
    researcher:
      - "patient:read_anonymized"
      - "data:export_anonymized"
    viewer:
      - "patient:read"
      - "data:view"
  
  # Session management
  session:
    timeout_minutes: 30
    max_concurrent: 3
    require_mfa: false

# Consent Management
consent:
  require_consent: true
  
  consent_types:
    - "treatment"
    - "research"
    - "data_sharing"
    - "ai_analysis"
  
  # Default consent
  default_consent:
    treatment: true
    research: false
    data_sharing: false
    ai_analysis: false

# Data Retention
retention:
  enabled: true
  
  # Retention periods (days)
  periods:
    patient_records: 2555  # 7 years
    audit_logs: 2555       # 7 years
    model_outputs: 365     # 1 year
    temporary_data: 30     # 30 days
  
  # Automatic deletion
  auto_delete:
    enabled: true
    grace_period_days: 30

# Breach Detection
breach_detection:
  enabled: true
  
  # Anomaly detection
  detect_anomalies:
    unusual_access_patterns: true
    bulk_data_export: true
    off_hours_access: true
    geographic_anomalies: false
  
  # Alerts
  alert_on_breach: true
  alert_contacts:
    - "security@hospital.org"
    - "compliance@hospital.org"

# Compliance Reports
compliance_reports:
  enabled: true
  schedule: "monthly"
  output_directory: "reports/compliance"
  include:
    - "access_logs"
    - "consent_status"
    - "breach_incidents"
    - "data_retention_status"
